name: Notify web-rainbow-ui to sync tokens

on:
  push:
    branches: [main]
    paths:
      - "tokens.json"
  workflow_dispatch:

jobs:
  dispatch:
    runs-on: ubuntu-latest

    steps:
      - name: Install GitHub CLI
        run: |
          sudo apt-get update
          sudo apt-get install -y gh

      - name: Dispatch repository_dispatch to web-rainbow-ui
        env:
          GH_TOKEN: ${{ secrets.WEB_RAINBOW_UI_DISPATCH_TOKEN }}
        run: |
          gh api --method POST repos/rainbow-mobile/web-rainbow-ui/dispatches \
            -f event_type=sync-design-tokens \
            -F client_payload[source_repo]=minhe8564/rb-design-tokens \
            -F client_payload[ref]=main \
            -F client_payload[path]=tokens.json
